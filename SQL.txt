1. SELECT DEPARTMENT.NAME, EMPLOYEE.NAME
FROM
    DEPARTMENT INNER JOIN EMPLOYEE
    ON DEPARTMENT.ID = EMPLOYEE.DEP_ID
WHERE EMPLOYEE.CHIEF_ID is null

2. SELECT DEPARTMENT.NAME
FROm DEPARTMENT INNER JOIN
    (select DEP_ID, SUBSTRING(EMPLOYEE.NAME, 1, CHARINDEX(' ', EMPLOYEE.NAME) - 1), count(*)
      from EMPLOYEE
      group by DEP_ID, SUBSTRING(EMPLOYEE.NAME, 1, CHARINDEX(' ', EMPLOYEE.NAME) - 1)
      having count(*) > 1) as surnames
ON DEPARTMENT.ID = surnames.DEP_ID

